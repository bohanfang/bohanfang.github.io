# Name of the workflow
name: Build and Deploy Jekyll Site

# Controls when the action will run.
# This workflow runs on pushes to the "main" branch.
on:
  push:
    branches:
      - main # Or "master", depending on your repo's default branch

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build_and_deploy"
  build_and_deploy:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    steps:
      # 1. Checks out your repository under $GITHUB_WORKSPACE, so your job can access it
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      # 2. Sets up Ruby, Bundler, and caches your gems
      - name: Setup Ruby, Bundler, and Jekyll ğŸ’
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: '3.1' # Use the Ruby version you prefer
          bundler-cache: true # Automatically runs "bundle install" and caches gems

      # 3. Builds the Jekyll site
      - name: Build Jekyll Site ğŸ”¨
        env: # <-- Add this block
          PAGES_REPO_NWO: ${{ github.repository }}
        run: bundle exec jekyll build
        env:
          JEKYLL_ENV: production

      # 4. Deploys the built site to the gh-pages branch
      - name: Deploy to GitHub Pages ğŸš€
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./_site # The folder Jekyll builds to
